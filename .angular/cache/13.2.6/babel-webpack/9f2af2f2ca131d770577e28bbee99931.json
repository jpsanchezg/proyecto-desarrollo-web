{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\Juan Camilo Merchan\\\\Documents\\\\Web\\\\proyecto-desarrollo-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { User } from 'src/app/model/user';\nimport { environment } from 'src/environments/environment';\nimport { Purchase } from 'src/app/model/purchase';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let UserControllerService = /*#__PURE__*/(() => {\n  class UserControllerService {\n    constructor(http) {\n      this.http = http;\n      this.currentUser = null;\n      this.listUsers = [];\n    }\n\n    login(username, password) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        try {\n          var responseBody = yield _this.http.post(`${environment.baseURL}/login`, {\n            username: username,\n            password: password\n          }, {\n            responseType: \"text\"\n          }).toPromise();\n          window.sessionStorage.setItem(\"jwt\", responseBody);\n          yield _this.getUserByUsername(username).then(value => {\n            _this.currentUser = value;\n          });\n          return true;\n        } catch (e) {\n          console.error(e);\n          _this.currentUser = null;\n          return false;\n        }\n      })();\n    }\n\n    addUser(name, username, password) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        try {\n          yield _this2.http.post(`${environment.baseURL}/user/create`, {\n            username: username,\n            password: password,\n            name: name\n          }).toPromise();\n        } catch (e) {\n          console.error(e);\n          return false;\n        }\n\n        return true;\n      })();\n    }\n\n    modUser(name, username, password, shoppingCart) {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        var body = {\n          username: username,\n          name: name,\n          password: password,\n          shoppingCart: shoppingCart\n        };\n        console.log(body);\n        yield _this3.http.put(`${environment.baseURL}/user/update`, body).toPromise();\n      })();\n    }\n\n    getCurrentUser() {\n      return this.currentUser;\n    }\n\n    getAllUsers() {\n      return this.listUsers;\n    }\n\n    getUserByUsername(username) {\n      var _this4 = this;\n\n      return _asyncToGenerator(function* () {\n        var user = new User();\n\n        try {\n          var json = yield _this4.http.get(`${environment.baseURL}/user/${username}`).toPromise();\n          user.setUsername(json.username);\n          user.setName(json.name);\n          user.setIsAdmin(json.admin);\n          var shoppingCart = json.shoppingCart;\n          shoppingCart.forEach(element => {\n            var purchase = new Purchase(element.productId, element.quantity);\n            purchase.setId(element.id);\n            user.addPurchaseInstance(purchase);\n          });\n          return user;\n        } catch (e) {\n          console.error(e);\n        }\n\n        return null;\n      })();\n    }\n\n    removeUser(username) {\n      this.http.delete(`${environment.baseURL}/user/delete/${username}`);\n    }\n\n    logOut() {\n      this.currentUser = null;\n      window.localStorage.removeItem(\"jwt\");\n    }\n\n  }\n\n  UserControllerService.ɵfac = function UserControllerService_Factory(t) {\n    return new (t || UserControllerService)(i0.ɵɵinject(i1.HttpClient));\n  };\n\n  UserControllerService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: UserControllerService,\n    factory: UserControllerService.ɵfac,\n    providedIn: 'root'\n  });\n  return UserControllerService;\n})();","map":null,"metadata":{},"sourceType":"module"}